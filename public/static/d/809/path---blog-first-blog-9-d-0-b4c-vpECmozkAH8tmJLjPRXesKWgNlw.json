{"data":{"markdownRemark":{"html":"<h1>TCP协议的3次握手与4次分手</h1>\n<h2>TCP协议的连接与断开</h2>\n<ul>\n<li>什么是TCP协议的三次握手？为什么会有三次握手？</li>\n<li>什么是TCO协议的四次分手？为什么会有四次分手？</li>\n</ul>\n<h2>问题解释</h2>\n<ul>\n<li>TCP的三次握手其实是在客户端与服务端建立一个TCP连接，在TCP/IP协议中，采用三次握手可建立可靠的连接服务</li>\n<li>\n<p>TCP的四次分手用来断开客户端与服务端的连接</p>\n<!--more-->\n<h2>详解</h2>\n<h3>TCP报文重要字段解释</h3>\n</li>\n<li>序号：<code>seq</code>序号，标识从TCP源向目的端发送字节流，并由发送端对其标记</li>\n<li>确认序号：<code>ack</code>序号，只有<code>ACK</code>标志位为1时确认序号字段才有效，<code>ack=seq+1</code>（注意：<code>ack</code>序号与<code>ACK</code>标志位不是同一个东西）</li>\n<li>注意：确认放<code>ack</code>=发起方<code>req+1</code>时两者配对成功</li>\n<li>\n<p>标志位：共六个，即<code>URG</code>,<code>ACK</code>,<code>PSH</code>,<code>RST</code>,<code>SYN</code>,<code>FIN</code></p>\n<ul>\n<li><code>ACK</code>:确认序号有效</li>\n<li><code>PSH</code>:接收方尽快将报文提交应用层</li>\n<li><code>RST</code>:连接重置</li>\n<li><code>URG</code>:紧急指针有效</li>\n<li><code>SYN</code>:发起一个新连接</li>\n<li>\n<p><code>FIN</code>:释放一个链接</p>\n<h3>三次握手</h3>\n</li>\n</ul>\n</li>\n<li>\n<p>三次握手是为了在客户端与服务端建立可靠安全的连接服务，所以需要三次握手确认</p>\n<ul>\n<li>第一次：客户端将标志位<code>SYN</code>设置为<code>1</code>，产生一个随机值<code>seq=J</code>并将其发送给server,等待server确认，自己进入<code>SYN_SENT</code>状态</li>\n<li>第二次：server收到数据包由<code>SYN=1</code>知道客户端建立请求，server将标志位<code>SYN</code>与<code>ACK</code>都设置为1，随机产生一个值<code>seq=K</code>，并将该数据发回客户端确认连接请求，server进入<code>SYN_RCVD</code>状态</li>\n<li>第三次：客户端收到确认后检查<code>ack</code>是否为<code>J+1</code>,<code>ACK</code>是否为<code>1</code>，如果正确则将标志位<code>ACK</code>设置为<code>1</code>，<code>ack=K+1</code>,并将数据包发给server，server检查<code>ack</code>是否为<code>K+1</code>,<code>ACK</code>是否为<code>1</code>，如果正确则连接建立成功，客户端与服务端进入<code>ESTABLISHED</code>状态，完成三次握手，此后客户端与服务端即可开始传输数据了</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"HTTP与TCP/IP了解","date":"2019-02-26","tags":["HTTP","TCP/IP"],"categories":"HTTP"},"fields":{"slug":"/first-blog/"}}},"pageContext":{"slug":"/first-blog/"}}